(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5041"],{"934e":function(e,s,t){"use strict";t.r(s);var u=function(){var e=this,s=e.$createElement,u=e._self._c||s;return u("div",{staticClass:"flex"},[u("div",{staticClass:"w-1/3"},[e._v(" "+e._s(e.usersIndex)+" ")]),u("div",{staticClass:"w-1/3 flex flex-col items-center"},[u("img",{staticClass:"w-12 h-12 mt-12",attrs:{src:t("ba61")}}),e.ui.login?u("p",{staticClass:"text-xl font-semibold text-blue-500 text-center mt-10 mb-4"},[e._v("THE WORKSMAN")]):u("p",{staticClass:"text-xl font-semibold text-blue-500 text-center mt-10 mb-5"},[e._v("THE WORKSMAN USER REGISTRATION")]),e.ui.success?u("p",{staticClass:"text-green-400 font-light text-lg p-5 mb-5"},[e.user.username?e._e():u("span",[e._v(e._s(e.ui.success))])]):e._e(),e.ui.message?u("p",{staticClass:"bg-white text-red-600 font-semibold text-xs p-1"},[e._v(e._s(e.ui.message))]):e._e(),e.ui.login?u("section",{staticClass:"flex flex-col mt-4 rounded-lg"},[u("div",[u("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.user.username,expression:"user.username",modifiers:{lazy:!0}}],staticClass:"input w-full mb-5",attrs:{type:"text",placeholder:"Username",focusout:e.setCookieId()},domProps:{value:e.user.username},on:{focusin:function(s){e.ui.warn=!1},change:function(s){return e.$set(e.user,"username",s.target.value)}}})]),u("div",[u("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.user.password,expression:"user.password",modifiers:{lazy:!0}}],staticClass:"input w-full",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.user.password},on:{focusin:function(s){e.ui.warn=!1},change:function(s){return e.$set(e.user,"password",s.target.value)}}})]),u("button",{staticClass:"btn-primary py-2 px-3 mt-10",attrs:{type:"submit"},on:{click:e.logIn}},[e._v("LOGIN")]),u("div",[u("p",{staticClass:"bg-white text-blue-600 font-semibold text-sm p-1 cursor-pointer",on:{click:function(s){e.ui.login=!e.ui.login}}},[e._v("or register")]),e._v(" "+e._s(e.cookieid)+" "),e.user.username?u("ul",[e.usernames.has(e.user.username)?u("li",[u("span",{staticClass:"text-xl text-green-400 font-bold"},[u("fadeOut",{attrs:{info:"Ok",directive:"success",delay:e.ui.fade.fast}})],1)]):u("li",[u("span",{staticClass:"text-xl text-red-400 font-bold"},[u("fadeOut",{attrs:{info:"Invalid Username!",directive:"danger",delay:e.ui.fade.faster}})],1)])]):e._e()])]):e._e(),e.ui.login?e._e():u("section",{staticClass:"flex flex-col mt-10 rounded-lg"},[u("ul",[e._l(e.account_request.user,(function(s,t){return u("li",{key:t},[u("div","password"!=t?[u("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.account_request.user[t],expression:"account_request.user[key]",modifiers:{lazy:!0}}],staticClass:"input mb-3 w-full",attrs:{type:"text",placeholder:t},domProps:{value:e.account_request.user[t]},on:{focus:function(s){e.ui.message=null},change:function(s){return e.$set(e.account_request.user,t,s.target.value)}}})]:[u("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.account_request.user[t],expression:"account_request.user[key]",modifiers:{lazy:!0}}],staticClass:"input mb-3 w-full",attrs:{type:t,placeholder:t},domProps:{value:e.account_request.user[t]},on:{change:function(s){return e.$set(e.account_request.user,t,s.target.value)}}})])])})),e._l(e.account_request.contact,(function(s,t){return u("li",{key:t},[u("div",[u("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.account_request.contact[t],expression:"account_request.contact[key]",modifiers:{lazy:!0}}],staticClass:"input mb-3 w-full",attrs:{type:"text",placeholder:t},domProps:{value:e.account_request.contact[t]},on:{change:function(s){return e.$set(e.account_request.contact,t,s.target.value)}}})])])}))],2),u("button",{staticClass:"btn-primary py-2 px-3 mt-5",attrs:{type:"submit"},on:{click:e.register}},[e._v("REGISTER")]),u("div",[u("p",{staticClass:"bg-white text-blue-600 font-semibold text-sm p-1 mt-3 cursor-pointer",on:{click:function(s){e.ui.login=!e.ui.login}}},[e._v("cancell")])])])]),u("div",{staticClass:"w-1/3"},[e.usernames?u("p",{staticClass:"bg-teal-300 text-teal-800"},[e._v(e._s(e.usernames))]):e._e()])])},a=[],n=(t("96cf"),t("1da1")),r=t("5530"),i=t("2f62"),o=t("a3bf"),l={name:"index",components:{fadeOut:o["a"]},data:function(){return{auid:null,count:0,delay:2e4,cookieid:null,user:{authed_user:localStorage.getItem("username"),username:null,password:null},account_request:{user:{username:null,password:null,firstname:null,lastname:null},contact:{email:null,tel:null,mobile:null},meta:{created:Date.parse(Date())}},ui:{login:!0,message:null,success:null,warn:!0,fade:{slow:2e4,fast:1e4,faster:5e3,fastest:2500}}}},mounted:function(){this.$store.dispatch("loadUsersIndex"),this.autoloadUser()},computed:Object(r["a"])({},Object(i["d"])({authed_user:function(e){return e.user.user},session:function(e){return e.sessions.session}}),{},Object(i["c"])({usersIndex:"usersIndex",usernames:"usernames",currentUser:"user"})),watch:{count:function(){this.count>2&&(this.registerUser(),this.count=0)},cookieid:function(){this.user.username}},methods:{autoloadUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:console.log("logged in user",e.user.authed_user),e.user.authed_user&&(e.cookieid=e.user.authed_user,e.$store.dispatch("loadSession",e.user.authed_user).then((function(s){e.ui.message="You are already Logged in !",e.$router.push("/userhome/"+s)})).catch((function(e){console.log("USER IS NOT LOGGED IN",e)})));case 2:case"end":return s.stop()}}),s)})))()},setCookieId:function(){var e=this;this.user.username&&(this.cookieid=this.user.username,console.log("REGISTERING USER",this.user.username),this.$store.dispatch("loadSession",this.user.username).then((function(s){console.log("CLIENT GOT FROM SESSION STORE",s),e.ui.message="You are already Logged in !",e.$router.push("/userhome/"+s)})).catch((function(e){console.log("USER IS NOT LOGGED IN",e)})))},logIn:function(){var e=this;if(this.usernames.has(this.user.username)&&this.user.password){console.log("LOGIN GOT",this.user.username);try{this.$store.dispatch("authUser",this.user).then((function(s){console.log("LOGIN PHASE 2",s),e.ui.message="AUTHENTICATED USER ".concat(s),e.$store.dispatch("setSession",s),setTimeout((function(){e.$store.dispatch("loadSession",s).then((function(s){console.log("COOKIE PROMISED TO LOGIN FROM STORE SESSION",s),e.$router.push("/userhome/"+s)})).catch((function(s){e.ui.message="YOU ARE NOT AUTORISED TO USE THIS PLATFORM ".concat(s)}))}),1e4)})).catch((function(s){e.ui.message="AUTHED FAILED ".concat(s.message),console.log("AUTH FAILED",s)}))}catch(s){this.ui.message=this.authed_user.message}}else this.usernames.has(this.user.username)&&!this.user.password?(this.ui.message="You Need to provide a valid Password!",this.count+=1):this.user.username?(this.ui.message="Invalid Credentials!",this.count+=1):(this.ui.message="You Need to provide Your Username!",this.count+=1)},registerUser:function(){alert("Hey Hold Up! You Failed ".concat(this.count," Login Attempts. Would you like to Register?")),this.ui.login=!this.ui.login,this.ui.message=null,this.account_request.user.username=this.user.username},register:function(){if(this.usernames.has(this.account_request.user.username))this.ui.message="Sorry That Username is already taken.",this.account_request.user.username=null;else{var e=this.account_request.user;e.contact=this.account_request.contact,e.meta=this.account_request.meta,this.$store.dispatch("registerUser",e),this.ui.login=!0,this.ui.success="Congratulations You are registered to Use The WorksMan. Please login!",this.account_request={user:{username:null,password:null,firstname:null,lastname:null},contact:{email:null,tel:null,mobile:null}}}}}},c=l,d=t("2877"),m=Object(d["a"])(c,u,a,!1,null,null,null);s["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0e5041.0237ab83.js.map